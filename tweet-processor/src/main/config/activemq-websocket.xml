<beans
        xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
  http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd">

    <bean id="appProperties" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <value>file:${activemq.conf}/credentials.properties</value>
        </property>
    </bean>

    <broker xmlns="http://activemq.apache.org/schema/core"
            brokerName="localhost-ws" dataDirectory="${activemq.data}">

        <plugins>
            <simpleAuthenticationPlugin anonymousAccessAllowed="true">
                <users>
                    <authenticationUser username="user" password="password" groups="users"/>
                </users>
            </simpleAuthenticationPlugin>
            <authorizationPlugin>
                <map>
                    <authorizationMap>
                        <authorizationEntries>
                            <authorizationEntry queue=">" read="admins" write="admins" admin="admins"/>
                            <authorizationEntry topic=">" read="admins" write="admins" admin="admins"/>
                            <authorizationEntry topic="twitter.tweet" read="users,anonymous" write="users"
                                                admin="users"/>
                            <authorizationEntry topic="ActiveMQ.Advisory.>" read="guests,users" write="guests,users"
                                                admin="guests,users"/>
                        </authorizationEntries>
                        <tempDestinationAuthorizationEntry>
                            <tempDestinationAuthorizationEntry read="tempDestinationAdmins"
                                                               write="tempDestinationAdmins"
                                                               admin="tempDestinationAdmins"/>
                        </tempDestinationAuthorizationEntry>
                    </authorizationMap>
                </map>
            </authorizationPlugin>
        </plugins>

        <transportConnectors>
            <transportConnector name="openwire" uri="tcp://0.0.0.0:61616"/>
            <transportConnector name="websocket" uri="ws://0.0.0.0:61614"/>
        </transportConnectors>

    </broker>

    <import resource="file:${activemq.conf}/jetty.xml"/>
</beans>
